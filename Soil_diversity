/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var table = ee.FeatureCollection("projects/ee-lucasljardim9/assets/soil_IBGE");
/***** End of imports. If edited, may not auto-convert in the playground. *****/
var bioma = ee.FeatureCollection("projects/ee-lucasljardim9/assets/Caatinga");

var soil = ee.FeatureCollection("projects/ee-lucasljardim9/assets/soil_IBGE")
           .select("cod_simbol");
           
soil_presence = function(code, feature){           
           
var type = soil.filter(ee.Filter.eq("cod_simbol", code))
           .map(
             function(feature){
             return feature.set("cod_simbol", 1)
             });
             
var soil_raster = type.reduceToImage({
             properties: ["cod_simbol"],
             reducer: ee.Reducer.first()
           });
           
var r = ee.Number(404686).divide(ee.Number(Math.PI)).sqrt() // radius in meters

var radius_pixels = r.divide(ee.Number(90)).round()

var soil_count = soil_raster.neighborhoodToBands(ee.Kernel.circle(radius_pixels)).reduce(ee.Reducer.count())
                    
    return soil_count.where(soil_count.gt(0), 1);        

}


var soil_codes = soil.reduceColumns(ee.Reducer.frequencyHistogram(), ["cod_simbol"]);

var test = soil_codes.map()
                 

//Map over soil codes to generate raster of soil presence                     



/*
Map.setCenter(-40, -8, 7)

Map.addLayer(soil_presence)
*/

/*   
Export.image.toDrive({
  image: soil_raster,
  description: 'soil_test',
  scale: 92.76624,
  region: bioma,
  maxPixels: 631694567
  })
*/
